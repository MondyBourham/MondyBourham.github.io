<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}" data-theme="auto">
  {% include head.html %}
  <body class="minima">
    <button class="toggle-dark-mode" id="theme-toggle" aria-label="Toggle dark mode">
      <i class="fas fa-moon"></i>
    </button>

    <div class="container">
      {{ content }}
    </div>

    {% include footer.html %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
    <script>
      const toggle = document.getElementById('theme-toggle');
      const html = document.documentElement;

      // Load saved or system preference
      const saved = localStorage.getItem('theme');
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const initial = saved || (systemDark ? 'dark' : 'light');
      if (saved) html.setAttribute('data-theme', saved);

      function updateIcon() {
        const isDark = html.getAttribute('data-theme') === 'dark' || 
                      (!saved && systemDark);
        toggle.innerHTML = `<i class="fas fa-${isDark ? 'sun' : 'moon'}"></i>`;
      }

      toggle.addEventListener('click', () => {
        const current = html.getAttribute('data-theme') || 'light';
        const next = current === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        updateIcon();
      });

      updateIcon();
    </script>
  </body>
</html>
